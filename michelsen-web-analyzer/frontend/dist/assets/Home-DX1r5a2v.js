import{d as M,r as n,c as S,a as i,b as s,e as v,f as D,t as I,w as K,v as F,n as Y,u as T,o as A,_ as O}from"./index-BkKPq0f4.js";const j="data:image/png;base64,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",P={class:"container px-4 space-y-8 mx-auto"},H={class:"grid grid-cols-1 lg:grid-cols-1 gap-8"},N={class:"card bg-base-100 shadow-xl"},J={class:"card-body"},V={key:0,class:"form-control"},G={key:1,class:"card-center"},z={class:"center-label"},W={class:"card bg-base-100 shadow-xl"},L={class:"card-body text-center"},Z={class:"form-control mb-6"},q={class:"cursor-pointer label justify-center"},X={class:"card-actions justify-center"},_=["disabled"],$={key:0},ee={key:1},se={key:0,class:"analysis-progress mt-6"},te={class:"mb-2"},ae={class:"text-sm font-medium"},oe=["value"],le={class:"mt-2 text-sm text-base-content/70"},ne={key:1,class:"alert alert-warning mt-4"},re=M({__name:"Home",setup(ie){const m=T(),k=n(null),p=n(null),h=n(""),u=n(""),Q=n(!0),r=n(!1),o=n(0),l=n(""),g=S(()=>p.value&&!r.value),b=async t=>{try{const e=await fetch(t,{mode:"cors"});if(!e.ok)throw new Error("Network response was not ok");return await e.blob()}catch(e){throw console.error("Error fetching file:",e),e}},y=(t,e)=>new File([t],e,{type:t.type}),f=async()=>{const t=await b("https://lib.fantasy-lab.com/video/teacher.mp4"),e=y(t,"标准操作视频.mp4");console.log(t,e),e&&(k.value=e,h.value=URL.createObjectURL(e),console.log(111,h.value))},U=async t=>{var c;await f();const a=(c=t.target.files)==null?void 0:c[0];a&&(p.value=a,u.value=URL.createObjectURL(a),localStorage.setItem("studentVideoUrl",u.value))},x=async()=>{if(g.value){r.value=!0,o.value=0,l.value="正在初始化分析...";try{l.value="上传老师示范视频...",o.value=10;const t=new FormData;if(t.append("file",k.value),!(await fetch("http://lab-score.fantasy-lab.com/api/upload/teacher",{method:"POST",body:t})).ok)throw new Error("老师视频上传失败");l.value="上传学生实验视频...",o.value=20;const a=new FormData;if(a.append("file",p.value),!(await fetch("http://lab-score.fantasy-lab.com/api/upload/student",{method:"POST",body:a})).ok)throw new Error("学生视频上传失败");l.value="启动AI分析引擎...",o.value=30;const w=await fetch("http://lab-score.fantasy-lab.com/api/analysis/start",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({include_device_detection:Q.value})});if(!w.ok)throw new Error("AI分析启动失败");const R=(await w.json()).analysis_id;l.value="AI正在分析实验步骤...";let B=!1;for(;!B;){await new Promise(E=>setTimeout(E,2e3));const C=await fetch(`http://lab-score.fantasy-lab.com/api/analysis/progress/${R}`);if(!C.ok)throw new Error("无法获取分析进度");const d=await C.json();if(o.value=Math.min(30+d.progress*.7,100),l.value=d.current_step||"AI正在分析中...",d.status==="completed")B=!0,o.value=100,l.value="分析完成！正在跳转到结果页面...";else if(d.status==="error")throw new Error(d.error||"分析过程中出现错误")}await new Promise(C=>setTimeout(C,1e3)),m.push("/analysis")}catch(t){console.error("分析失败:",t),alert(`AI分析失败: ${t.message}

请检查：
1. 后端服务是否正常运行
2. 视频文件是否正确
3. 网络连接是否稳定`),o.value=0,l.value=""}finally{r.value=!1}}};return(t,e)=>{var a;return A(),i("div",P,[e[7]||(e[7]=s("div",{class:"text-center"},[s("h1",{class:"text-4xl font-bold text-primary mb-4"}," 🧪 迈克尔逊干涉实验 AI 分析系统 "),s("p",{class:"text-lg text-base-content/70"}," 上传实验视频，AI 智能分析实验步骤并生成详细报告 ")],-1)),s("div",H,[s("div",N,[s("div",J,[e[3]||(e[3]=s("h2",{class:"card-title text-secondary"},"🎓 学生实验视频",-1)),u.value?v("",!0):(A(),i("div",V,[e[1]||(e[1]=s("label",{class:"label"},[s("span",{class:"label-text"},"选择学生实验视频文件")],-1)),s("input",{type:"file",accept:"video/*",class:"file-input file-input-bordered file-input-secondary",onChange:U},null,32),s("input",{type:"file",hidden:"",accept:"video/*",class:"file-input file-input-bordered file-input-primary",onChange:f},null,32)])),u.value?(A(),i("div",G,[s("div",z,[e[2]||(e[2]=s("img",{src:j,style:{width:"20px","margin-right":"4px"}},null,-1)),D(I((a=p.value)==null?void 0:a.name),1)]),s("input",{type:"file",hidden:"",accept:"video/*",class:"file-input file-input-bordered file-input-primary",onChange:f},null,32)])):v("",!0)])])]),s("div",W,[s("div",L,[e[6]||(e[6]=s("h2",{class:"card-title justify-center text-2xl mb-4"},"🚀 AI 分析控制",-1)),s("div",Z,[s("label",q,[K(s("input",{type:"checkbox","onUpdate:modelValue":e[0]||(e[0]=c=>Q.value=c),class:"checkbox checkbox-primary"},null,512),[[F,Q.value]]),e[4]||(e[4]=s("span",{class:"label-text ml-2"},"包含设备检测 (108秒单帧)",-1))])]),s("div",X,[s("button",{class:Y(["btn btn-primary btn-lg",{"btn-disabled":!g.value,loading:r.value}]),disabled:!g.value||r.value,onClick:x},[r.value?(A(),i("span",ee,"正在分析中...")):(A(),i("span",$,"🧠 开始 AI 实验步骤分析"))],10,_)]),r.value?(A(),i("div",se,[s("div",te,[s("span",ae,"分析进度: "+I(o.value)+"%",1)]),s("progress",{class:"progress progress-primary",value:o.value,max:"100"},null,8,oe),s("div",le,I(l.value),1)])):v("",!0),g.value?v("",!0):(A(),i("div",ne,e[5]||(e[5]=[s("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})],-1),s("span",null,"请先上传学生实验视频",-1)])))])])])}}}),de=O(re,[["__scopeId","data-v-662eb6bc"]]);export{de as default};
